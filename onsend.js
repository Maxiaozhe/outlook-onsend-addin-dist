!function(t){var e={};function n(o){if(e[o])return e[o].exports;var r=e[o]={i:o,l:!1,exports:{}};return t[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=t,n.c=e,n.d=function(t,e,o){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(o,r,function(e){return t[e]}.bind(null,r));return o},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=534)}({33:function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n},52:function(t,e,n){(function(e,n){
/*!
 * @overview es6-promise - a tiny implementation of Promises/A+.
 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
 * @license   Licensed under MIT license
 *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE
 * @version   v4.2.8+1e68dce6
 */var o;o=function(){"use strict";function t(t){return"function"==typeof t}var o=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)},r=0,i=void 0,s=void 0,c=function(t,e){h[r]=t,h[r+1]=e,2===(r+=2)&&(s?s(v):_())},u="undefined"!=typeof window?window:void 0,a=u||{},l=a.MutationObserver||a.WebKitMutationObserver,f="undefined"==typeof self&&void 0!==e&&"[object process]"==={}.toString.call(e),d="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function p(){var t=setTimeout;return function(){return t(v,1)}}var h=new Array(1e3);function v(){for(var t=0;t<r;t+=2)(0,h[t])(h[t+1]),h[t]=void 0,h[t+1]=void 0;r=0}var y,m,g,b,_=void 0;function w(t,e){var n=this,o=new this.constructor(O);void 0===o[x]&&U(o);var r=n._state;if(r){var i=arguments[r-1];c((function(){return M(r,o,i,n._result)}))}else I(n,o,t,e);return o}function A(t){if(t&&"object"==typeof t&&t.constructor===this)return t;var e=new this(O);return k(e,t),e}f?_=function(){return e.nextTick(v)}:l?(m=0,g=new l(v),b=document.createTextNode(""),g.observe(b,{characterData:!0}),_=function(){b.data=m=++m%2}):d?((y=new MessageChannel).port1.onmessage=v,_=function(){return y.port2.postMessage(0)}):_=void 0===u?function(){try{var t=Function("return this")().require("vertx");return void 0!==(i=t.runOnLoop||t.runOnContext)?function(){i(v)}:p()}catch(t){return p()}}():p();var x=Math.random().toString(36).substring(2);function O(){}function S(e,n,o){n.constructor===e.constructor&&o===w&&n.constructor.resolve===A?function(t,e){1===e._state?j(t,e._result):2===e._state?E(t,e._result):I(e,void 0,(function(e){return k(t,e)}),(function(e){return E(t,e)}))}(e,n):void 0===o?j(e,n):t(o)?function(t,e,n){c((function(t){var o=!1,r=function(t,e,n,o){try{t.call(e,n,o)}catch(t){return t}}(n,e,(function(n){o||(o=!0,e!==n?k(t,n):j(t,n))}),(function(e){o||(o=!0,E(t,e))}),t._label);!o&&r&&(o=!0,E(t,r))}),t)}(e,n,o):j(e,n)}function k(t,e){if(t===e)E(t,new TypeError("You cannot resolve a promise with itself"));else if(r=typeof(o=e),null===o||"object"!==r&&"function"!==r)j(t,e);else{var n=void 0;try{n=e.then}catch(e){return void E(t,e)}S(t,e,n)}var o,r}function T(t){t._onerror&&t._onerror(t._result),P(t)}function j(t,e){void 0===t._state&&(t._result=e,t._state=1,0!==t._subscribers.length&&c(P,t))}function E(t,e){void 0===t._state&&(t._state=2,t._result=e,c(T,t))}function I(t,e,n,o){var r=t._subscribers,i=r.length;t._onerror=null,r[i]=e,r[i+1]=n,r[i+2]=o,0===i&&t._state&&c(P,t)}function P(t){var e=t._subscribers,n=t._state;if(0!==e.length){for(var o=void 0,r=void 0,i=t._result,s=0;s<e.length;s+=3)o=e[s],r=e[s+n],o?M(n,o,r,i):r(i);t._subscribers.length=0}}function M(e,n,o,r){var i=t(o),s=void 0,c=void 0,u=!0;if(i){try{s=o(r)}catch(t){u=!1,c=t}if(n===s)return void E(n,new TypeError("A promises callback cannot return that same promise."))}else s=r;void 0!==n._state||(i&&u?k(n,s):!1===u?E(n,c):1===e?j(n,s):2===e&&E(n,s))}var R=0;function U(t){t[x]=R++,t._state=void 0,t._result=void 0,t._subscribers=[]}var H=function(){function t(t,e){this._instanceConstructor=t,this.promise=new t(O),this.promise[x]||U(this.promise),o(e)?(this.length=e.length,this._remaining=e.length,this._result=new Array(this.length),0===this.length?j(this.promise,this._result):(this.length=this.length||0,this._enumerate(e),0===this._remaining&&j(this.promise,this._result))):E(this.promise,new Error("Array Methods must be provided an Array"))}return t.prototype._enumerate=function(t){for(var e=0;void 0===this._state&&e<t.length;e++)this._eachEntry(t[e],e)},t.prototype._eachEntry=function(t,e){var n=this._instanceConstructor,o=n.resolve;if(o===A){var r=void 0,i=void 0,s=!1;try{r=t.then}catch(t){s=!0,i=t}if(r===w&&void 0!==t._state)this._settledAt(t._state,e,t._result);else if("function"!=typeof r)this._remaining--,this._result[e]=t;else if(n===L){var c=new n(O);s?E(c,i):S(c,t,r),this._willSettleAt(c,e)}else this._willSettleAt(new n((function(e){return e(t)})),e)}else this._willSettleAt(o(t),e)},t.prototype._settledAt=function(t,e,n){var o=this.promise;void 0===o._state&&(this._remaining--,2===t?E(o,n):this._result[e]=n),0===this._remaining&&j(o,this._result)},t.prototype._willSettleAt=function(t,e){var n=this;I(t,void 0,(function(t){return n._settledAt(1,e,t)}),(function(t){return n._settledAt(2,e,t)}))},t}(),L=function(){function e(t){this[x]=R++,this._result=this._state=void 0,this._subscribers=[],O!==t&&("function"!=typeof t&&function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof e?function(t,e){try{e((function(e){k(t,e)}),(function(e){E(t,e)}))}catch(e){E(t,e)}}(this,t):function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}())}return e.prototype.catch=function(t){return this.then(null,t)},e.prototype.finally=function(e){var n=this.constructor;return t(e)?this.then((function(t){return n.resolve(e()).then((function(){return t}))}),(function(t){return n.resolve(e()).then((function(){throw t}))})):this.then(e,e)},e}();return L.prototype.then=w,L.all=function(t){return new H(this,t).promise},L.race=function(t){var e=this;return o(t)?new e((function(n,o){for(var r=t.length,i=0;i<r;i++)e.resolve(t[i]).then(n,o)})):new e((function(t,e){return e(new TypeError("You must pass an array to race."))}))},L.resolve=A,L.reject=function(t){var e=new this(O);return E(e,t),e},L._setScheduler=function(t){s=t},L._setAsap=function(t){c=t},L._asap=c,L.polyfill=function(){var t=void 0;if(void 0!==n)t=n;else if("undefined"!=typeof self)t=self;else try{t=Function("return this")()}catch(t){throw new Error("polyfill failed because global object is unavailable in this environment")}var e=t.Promise;if(e){var o=null;try{o=Object.prototype.toString.call(e.resolve())}catch(t){}if("[object Promise]"===o&&!e.cast)return}t.Promise=L},L.Promise=L,L},t.exports=o()}).call(this,n(85),n(33))},534:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(535),r=n(536);o.app.addEventHook((function(t){return console.log(t.source.id),new r.default(Office.context.mailbox).saveItemAsync().then((function(){var t=window.location.origin+"/taskpane.html";return o.app.OpenDialogAsync(t,70,60).then((function(t){return null==t.error?t.message:(console.log(t.error),!1)}))}))})),function(){var t="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0;if(t){var n="undefined"!=typeof __webpack_exports__?__webpack_exports__:e;if(n)if("function"!=typeof n){for(var o in n)if(Object.prototype.hasOwnProperty.call(n,o)){var r=void 0;try{r=n[o]}catch(t){continue}t.register(r,o,"/Users/maxz/Projects/outlook-addin/onsend-addin/src/onsend/index.ts")}}else t.register(n,"module.exports","/Users/maxz/Projects/outlook-addin/onsend-addin/src/onsend/index.ts")}}()},535:function(t,e,n){"use strict";(function(t,n){var o=this&&this.__awaiter||function(e,n,o,r){return new(o||(o=t))((function(t,i){function s(t){try{u(r.next(t))}catch(t){i(t)}}function c(t){try{u(r.throw(t))}catch(t){i(t)}}function u(e){var n;e.done?t(e.value):(n=e.value,n instanceof o?n:new o((function(t){t(n)}))).then(s,c)}u((r=r.apply(e,n||[])).next())}))},r=this&&this.__generator||function(t,e){var n,o,r,i,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(i){return function(c){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,o=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(r=(r=s.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){s.label=i[1];break}if(6===i[0]&&s.label<r[1]){s.label=r[1],r=i;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(i);break}r[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(t){i=[6,t],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,c])}}};Object.defineProperty(e,"__esModule",{value:!0});var i=new(function(){function e(){this.initlized=!1,this.onsendHooks=[],this.getGlobal().OnSendEvent=this.onSendEvent,this.init()}return e.prototype.init=function(){var t=this;Office.onReady((function(){t.mailboxItem=Office.context.mailbox.item,t.thisUser=Office.context.mailbox.userProfile.emailAddress,t.initlized=!0}))},e.prototype.addEventHook=function(t){this.onsendHooks.push(t)},e.prototype.getGlobal=function(){return"undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==n?n:void 0},e.prototype.onSendEvent=function(e){return o(this,void 0,void 0,(function(){var n,o,s,c;return r(this,(function(r){for(n=[],o=0,s=i.onsendHooks;o<s.length;o++)c=s[o],n.push(c(e));return t.all(n).then((function(t){for(var n=0,o=t;n<o.length;n++){if(!o[n])return void e.completed({allowEvent:!1})}e.completed({allowEvent:!0})})),[2]}))}))},e.prototype.showInformation=function(t){this.mailboxItem.notificationMessages.addAsync("information",{type:"informationalMessage",message:t,icon:"icon16",persistent:!1})},e.prototype.OpenDialogAsync=function(e,n,i){return o(this,void 0,void 0,(function(){var o;return r(this,(function(r){return o={message:null,error:null},[2,new t((function(t){Office.context.ui.displayDialogAsync(e,{height:n,width:i,displayInIframe:!0},(function(e){var n=e.value;console.log(e),void 0!==n&&(n.addEventHandler(Office.EventType.DialogMessageReceived,(function(e){console.log("DialogMessageReceived=>",e),n.close(),o.message=JSON.parse(e.message),t(o)})),n.addEventHandler(Office.EventType.DialogEventReceived,(function(e){console.log("DialogEventReceived=>",e),n.close(),o.error=e.error,t(o)})))}))}))]}))}))},e}());e.app=i,function(){var t="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0;if(t){var n="undefined"!=typeof __webpack_exports__?__webpack_exports__:e;if(n)if("function"!=typeof n){for(var o in n)if(Object.prototype.hasOwnProperty.call(n,o)){var r=void 0;try{r=n[o]}catch(t){continue}t.register(r,o,"/Users/maxz/Projects/outlook-addin/onsend-addin/src/onsend/onsend-app.ts")}}else t.register(n,"module.exports","/Users/maxz/Projects/outlook-addin/onsend-addin/src/onsend/onsend-app.ts")}}()}).call(this,n(52).Promise,n(33))},536:function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function e(t){this.mailbox=t,this.item=t.item}return e.prototype.saveItem=function(){var e=Office.context.mailbox.item;return new t((function(t){e.saveAsync((function(e){e.status===Office.AsyncResultStatus.Succeeded?t(e.value):t(null)}))}))},e.prototype.getEmailsAsync=function(e){return new t((function(t,n){e.getAsync((function(e){e.status===Office.AsyncResultStatus.Succeeded?(console.info("getEmailsAsync",e.value),t(e.value)):(console.error("getEmailsAsync Error:",e),n(e.error))}))}))},e.prototype.getSubjectAsync=function(){var t=this;return new Office.Promise((function(e,n){t.item.subject.getAsync((function(t){t.status===Office.AsyncResultStatus.Succeeded?(console.info("getSubjectAsync",t.value),e(t.value)):(console.error("getSubjectAsync Error:",t),n(t.error))}))}))},e.prototype.getItemIdAsync=function(){var e=this;return new t((function(t,n){e.item.getItemIdAsync((function(e){e.status===Office.AsyncResultStatus.Succeeded?(console.info("getItemIdAsync",e.value),t(e.value)):n(e.error)}))}))},e.prototype.getUserIdentityTokenAsync=function(){var e=this;return new t((function(t,n){e.mailbox.getUserIdentityTokenAsync((function(e){e.status===Office.AsyncResultStatus.Succeeded?(console.warn("getUserIdentityTokenAsync",e.value),t(e.value)):n(e.error)}))}))},e.prototype.getCallbackTokenAsync=function(){var e=this;return new t((function(t,n){e.mailbox.getCallbackTokenAsync({isRest:!0},(function(e){e.status===Office.AsyncResultStatus.Succeeded?(console.info("getCallbackTokenAsync",e.value),t(e.value)):n(e.error)}))}))},e.prototype.getFromAsync=function(){var e=this;return new t((function(t,n){e.item.from.getAsync((function(e){e.status===Office.AsyncResultStatus.Succeeded?(console.info("getFromAsync",e.value),t(e.value)):(console.error("getFromAsync Error:",e),n(e.error))}))}))},e.prototype.getPropAsync=function(e){var n=this;return new t((function(t){n.item.loadCustomPropertiesAsync((function(n){var o=n.value.get(e);n.status===Office.AsyncResultStatus.Succeeded&&o?t(o):t(null)}))}))},e.prototype.saveItemAsync=function(){var e=this.item,n=this.saveItem(),o=this.getEmailsAsync(e.to),r=this.getEmailsAsync(e.cc),i=this.getEmailsAsync(e.bcc),s=this.getFromAsync(),c=this.getSubjectAsync(),u=this.getCallbackTokenAsync();return t.all([o,r,i,s,c,n,u]).then((function(t){var e=t[0],n=t[1],o=t[2],r=t[3],i=t[4],s=t[5],c=t[6],u=Office.context.mailbox.userProfile,a={to:e,cc:n,bcc:o,from:r,subject:i,itemId:Office.context.mailbox.convertToRestId(s,"v2.0"),user:u},l={restUrl:Office.context.mailbox.restUrl,callbackToken:c};console.info("copyItem=>",a),console.info("RestApiInfo=>",l),localStorage.removeItem("mailItem"),localStorage.removeItem("RestInfo"),localStorage.setItem("mailItem",JSON.stringify(a)),localStorage.setItem("RestInfo",JSON.stringify(l))}))},e}();e.default=n,function(){var t="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0;if(t){var n="undefined"!=typeof __webpack_exports__?__webpack_exports__:e;if(n)if("function"!=typeof n){for(var o in n)if(Object.prototype.hasOwnProperty.call(n,o)){var r=void 0;try{r=n[o]}catch(t){continue}t.register(r,o,"/Users/maxz/Projects/outlook-addin/onsend-addin/src/common/officeUtil.ts")}}else t.register(n,"module.exports","/Users/maxz/Projects/outlook-addin/onsend-addin/src/common/officeUtil.ts")}}()}).call(this,n(52).Promise)},85:function(t,e){var n,o,r=t.exports={};function i(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function c(t){if(n===setTimeout)return setTimeout(t,0);if((n===i||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:i}catch(t){n=i}try{o="function"==typeof clearTimeout?clearTimeout:s}catch(t){o=s}}();var u,a=[],l=!1,f=-1;function d(){l&&u&&(l=!1,u.length?a=u.concat(a):f=-1,a.length&&p())}function p(){if(!l){var t=c(d);l=!0;for(var e=a.length;e;){for(u=a,a=[];++f<e;)u&&u[f].run();f=-1,e=a.length}u=null,l=!1,function(t){if(o===clearTimeout)return clearTimeout(t);if((o===s||!o)&&clearTimeout)return o=clearTimeout,clearTimeout(t);try{o(t)}catch(e){try{return o.call(null,t)}catch(e){return o.call(this,t)}}}(t)}}function h(t,e){this.fun=t,this.array=e}function v(){}r.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];a.push(new h(t,e)),1!==a.length||l||c(p)},h.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=v,r.addListener=v,r.once=v,r.off=v,r.removeListener=v,r.removeAllListeners=v,r.emit=v,r.prependListener=v,r.prependOnceListener=v,r.listeners=function(t){return[]},r.binding=function(t){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(t){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}}});
//# sourceMappingURL=onsend.js.map